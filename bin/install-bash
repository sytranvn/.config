#!/usr/bin/env bash

if [[ ! "$BASH_VERSION" = 3.* ]]; then
	exit 0
fi

if [ ! "$macos" = yes ] || [ ! "$(arch)" = "arm64" ]; then
	echo This script only run on MacOS M1, checkout bash/README.md for manual steps.
	exit 1
fi

brew install bash
echo /opt/homebrew/bin/bash | sudo tee -a /etc/shells
chsh -s /opt/homebrew/bin/bash
echo '[ -f ~/.config/bash/.bashrc ] && . ~/.config/bash/.bashrc' >> ~/.profile
echo '[[ -r "$(brew --prefix)/etc/profile.d/bash_completion.sh" ]] && . "$(brew --prefix)/etc/profile.d/bash_completion.sh"' >> ~/.profile 

echo Bash has been installed. Quit terminal and restart.
