# vi: ft=sh :
function message {
	echo [$(basename $0)] "$@"
}

if [[ $BASH_VERSINFO -gt 4 ]]; then
	message Bash $BASH_VERSION installed
	exit 0
fi

if [ ! "$macos" = yes ] || [ ! "$(arch)" = "arm64" ]; then
	message 'This script only run on MacOS M1, checkout bash/README.md for manual steps.'
	exit 0
fi

brew install bash
echo /opt/homebrew/bin/bash | sudo tee -a /etc/shells
chsh -s /opt/homebrew/bin/bash
echo '# auto setup bash
[ -f ~/.config/bash/.bashrc ] && . ~/.config/bash/.bashrc
# end auto setup bash' >> ~/.profile 

message Bash has been installed. Quit terminal and restart.

